DROP VIEW vw_master_list_data //
CREATE view vw_master_list_data as
SELECT FACILITY, active,
    SUM(CASE WHEN GENDER='Male' AND age<1 AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '1MONEMONTH',
    SUM(CASE WHEN GENDER='Female' AND age<1 AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '1FONEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>0 AND age<5) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '1-4MONEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>0 AND age<5) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '1-4FONEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>4 AND age<10) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '5-9MONEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>4 AND age<10) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '5-9FONEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>9 AND age<15) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '10-14MONEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>9 AND age<15) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '10-14FONEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>14 AND age<20) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '15-19MONEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>14 AND age<20) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '15-19FONEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>19 AND age<25) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '20-24MONEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>19 AND age<25) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '20-24FONEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>24 AND age<30) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '25-29MONEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>24 AND age<30) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '25-29FONEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>29 AND age<35) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '30-34MONEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>29 AND age<35) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '30-34FONEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>34 AND age<40) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '35-39MONEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>34 AND age<40) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '35-39FONEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>39 AND age<45) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '40-44MONEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>39 AND age<45) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '40-44FONEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>44 AND age<50) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '45-49MONEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>44 AND age<50) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '45-49FONEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>=50) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '50MONEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>=50) AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  '50FONEMONTH',
    SUM(CASE WHEN (GENDER='Female' or GENDER='Male') AND (DIFFAPPDISP>=0 and DIFFAPPDISP<36) THEN 1 else 0 end ) AS  'SUBTOTAL1MONTH',

    SUM(CASE WHEN GENDER='Male' AND age<1 AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '1MTWOMONTH',
    SUM(CASE WHEN GENDER='Female' AND age<1 AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '1FTWOMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>0 AND age<5) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '1-4MTWOMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>0 AND age<5) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '1-4FTWOMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>4 AND age<10) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '5-9MTWOMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>4 AND age<10) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '5-9FTWOMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>9 AND age<15) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '10-14MTWOMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>9 AND age<15) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '10-14FTWOMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>14 AND age<20) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '15-19MTWOMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>14 AND age<20) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '15-19FTWOMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>19 AND age<25) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '20-24MTWOMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>19 AND age<25) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '20-24FTWOMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>24 AND age<30) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '25-29MTWOMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>24 AND age<30) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '25-29FTWOMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>29 AND age<35) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '30-34MTWOMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>29 AND age<35) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '30-34FTWOMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>34 AND age<40) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '35-39MTWOMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>34 AND age<40) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '35-39FTWOMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>39 AND age<45) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '40-44MTWOMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>39 AND age<45) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '40-44FTWOMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>44 AND age<50) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '45-49MTWOMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>44 AND age<50) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '45-49FTWOMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>=50) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '50MTWOMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>=50) AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  '50FTWOMONTH',
    SUM(CASE WHEN (GENDER='Female' or GENDER='Male') AND (DIFFAPPDISP>35 and DIFFAPPDISP<66) THEN 1 else 0 end ) AS  'SUBTOTAL2MONTH',

    SUM(CASE WHEN GENDER='Male' AND age<1 AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '1MTHREEMONTH',
    SUM(CASE WHEN GENDER='Female' AND age<1 AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '1FTHREEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>60 AND age<5) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '1-4MTHREEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>60 AND age<5) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '1-4FTHREEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>4 AND age<10) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '5-9MTHREEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>4 AND age<10) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '5-9FTHREEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>9 AND age<15) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '10-14MTHREEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>9 AND age<15) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '10-14FTHREEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>14 AND age<20) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '15-19MTHREEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>14 AND age<20) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '15-19FTHREEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>19 AND age<25) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '20-24MTHREEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>19 AND age<25) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '20-24FTHREEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>24 AND age<30) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '25-29MTHREEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>24 AND age<30) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '25-29FTHREEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>29 AND age<35) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '30-34MTHREEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>29 AND age<35) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '30-34FTHREEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>34 AND age<40) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '35-39MTHREEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>34 AND age<40) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '35-39FTHREEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>39 AND age<45) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '40-44MTHREEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>39 AND age<45) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '40-44FTHREEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>44 AND age<50) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '45-49MTHREEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>44 AND age<50) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '45-49FTHREEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>=50) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '50MTHREEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>=50) AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  '50FTHREEMONTH',
    SUM(CASE WHEN (GENDER='Female' or GENDER='Male') AND (DIFFAPPDISP>65 and DIFFAPPDISP<96) THEN 1 else 0 end ) AS  'SUBTOTAL3MONTH',


    SUM(CASE WHEN GENDER='Male' AND age<1 AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '1MFOURMONTH',
    SUM(CASE WHEN GENDER='Female' AND age<1 AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '1FFOURMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>90 AND age<5) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '1-4MFOURMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>90 AND age<5) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '1-4FFOURMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>4 AND age<10) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '5-9MFOURMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>4 AND age<10) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '5-9FFOURMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>9 AND age<15) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '10-14MFOURMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>9 AND age<15) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '10-14FFOURMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>14 AND age<20) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '15-19MFOURMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>14 AND age<20) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '15-19FFOURMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>19 AND age<25) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '20-24MFOURMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>19 AND age<25) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '20-24FFOURMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>24 AND age<30) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '25-29MFOURMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>24 AND age<30) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '25-29FFOURMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>29 AND age<35) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '30-34MFOURMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>29 AND age<35) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '30-34FFOURMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>34 AND age<40) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '35-39MFOURMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>34 AND age<40) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '35-39FFOURMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>39 AND age<45) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '40-44MFOURMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>39 AND age<45) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '40-44FFOURMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>44 AND age<50) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '45-49MFOURMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>44 AND age<50) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '45-49FFOURMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>=50) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '50MFOURMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>=50) AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  '50FFOURMONTH',
    SUM(CASE WHEN (GENDER='Female' or GENDER='Male') AND (DIFFAPPDISP>95 and DIFFAPPDISP<126) THEN 1 else 0 end ) AS  'SUBTOTAL4MONTH',

    SUM(CASE WHEN GENDER='Male' AND age<1 AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '1MFIVEMONTH',
    SUM(CASE WHEN GENDER='Female' AND age<1 AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '1FFIVEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>90 AND age<5) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '1-4MFIVEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>90 AND age<5) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '1-4FFIVEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>4 AND age<10) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '5-9MFIVEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>4 AND age<10) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '5-9FFIVEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>9 AND age<15) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '10-14MFIVEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>9 AND age<15) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '10-14FFIVEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>14 AND age<20) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '15-19MFIVEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>14 AND age<20) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '15-19FFIVEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>19 AND age<25) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '20-24MFIVEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>19 AND age<25) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '20-24FFIVEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>24 AND age<30) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '25-29MFIVEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>24 AND age<30) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '25-29FFIVEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>29 AND age<35) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '30-34MFIVEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>29 AND age<35) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '30-34FFIVEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>34 AND age<40) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '35-39MFIVEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>34 AND age<40) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '35-39FFIVEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>39 AND age<45) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '40-44MFIVEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>39 AND age<45) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '40-44FFIVEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>44 AND age<50) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '45-49MFIVEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>44 AND age<50) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '45-49FFIVEMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>=50) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '50MFIVEMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>=50) AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  '50FFIVEMONTH',
    SUM(CASE WHEN (GENDER='Female' or GENDER='Male') AND (DIFFAPPDISP>125 and DIFFAPPDISP<156) THEN 1 else 0 end ) AS  'SUBTOTAL5MONTH',


    SUM(CASE WHEN GENDER='Male' AND age<1 AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '1MSIXMONTH',
    SUM(CASE WHEN GENDER='Female' AND age<1 AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '1FSIXMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>90 AND age<5) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '1-4MSIXMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>90 AND age<5) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '1-4FSIXMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>4 AND age<10) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '5-9MSIXMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>4 AND age<10) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '5-9FSIXMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>9 AND age<15) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '10-14MSIXMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>9 AND age<15) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '10-14FSIXMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>14 AND age<20) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '15-19MSIXMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>14 AND age<20) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '15-19FSIXMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>19 AND age<25) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '20-24MSIXMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>19 AND age<25) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '20-24FSIXMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>24 AND age<30) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '25-29MSIXMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>24 AND age<30) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '25-29FSIXMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>29 AND age<35) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '30-34MSIXMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>29 AND age<35) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '30-34FSIXMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>34 AND age<40) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '35-39MSIXMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>34 AND age<40) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '35-39FSIXMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>39 AND age<45) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '40-44MSIXMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>39 AND age<45) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '40-44FSIXMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>44 AND age<50) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '45-49MSIXMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>44 AND age<50) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '45-49FSIXMONTH',
    SUM(CASE WHEN GENDER='Male' AND (age>=50) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '50MSIXMONTH',
    SUM(CASE WHEN GENDER='Female' AND (age>=50) AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  '50FSIXMONTH',
    SUM(CASE WHEN (GENDER='Female' or GENDER='Male') AND (DIFFAPPDISP>155) THEN 1 else 0 end ) AS  'SUBTOTAL6MONTH',
    SUM(CASE WHEN (GENDER='Female' or GENDER='Male') THEN 1 else 0 end ) AS  'TOTALMONTHS',

    SUM(CASE WHEN GENDER='Male' AND age<1 AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMSMLESS1YEAR',
    SUM(CASE WHEN GENDER='Female' AND age<1 AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMSFLESS1YEAR',
    SUM(CASE WHEN GENDER='Male' AND (age>0 AND age<5) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS1-4M',
    SUM(CASE WHEN GENDER='Female' AND (age>0 AND age<5) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS1-4F',
    SUM(CASE WHEN GENDER='Male' AND (age>4 AND age<10) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS5-9M',
    SUM(CASE WHEN GENDER='Female' AND (age>4 AND age<10) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS5-9F',
    SUM(CASE WHEN GENDER='Male' AND (age>9 AND age<15) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS10-14M',
    SUM(CASE WHEN GENDER='Female' AND (age>9 AND age<15) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS10-14F',
    SUM(CASE WHEN GENDER='Male' AND (age>14 AND age<20) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS15-19M',
    SUM(CASE WHEN GENDER='Female' AND (age>14 AND age<20) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS15-19F',
    SUM(CASE WHEN GENDER='Male' AND (age>19 AND age<25) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS20-24M',
    SUM(CASE WHEN GENDER='Female' AND (age>19 AND age<25) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS20-24F',
    SUM(CASE WHEN GENDER='Male' AND (age>24 AND age<30) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS25-29M',
    SUM(CASE WHEN GENDER='Female' AND (age>24 AND age<30) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS25-29F',
    SUM(CASE WHEN GENDER='Male' AND (age>29 AND age<35) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS30-34M',
    SUM(CASE WHEN GENDER='Female' AND (age>29 AND age<35) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS30-34F',
    SUM(CASE WHEN GENDER='Male' AND (age>34 AND age<40) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS35-39M',
    SUM(CASE WHEN GENDER='Female' AND (age>34 AND age<40) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS35-39F',
    SUM(CASE WHEN GENDER='Male' AND (age>39 AND age<45) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS40-44M',
    SUM(CASE WHEN GENDER='Female' AND (age>39 AND age<45) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS40-44F',
    SUM(CASE WHEN GENDER='Male' AND (age>44 AND age<50) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS45-49M',
    SUM(CASE WHEN GENDER='Female' AND (age>44 AND age<50) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMS45-49F',
    SUM(CASE WHEN GENDER='Male' AND (age>=50) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMSOVER50M',
    SUM(CASE WHEN GENDER='Female' AND (age>=50) AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMSOVER50F',
    SUM(CASE WHEN (GENDER='Female' or GENDER='Male') AND DIFFERENTIATED_CARE=1 THEN 1 else 0 end ) AS  'MMSTOTAL'

FROM vw_master_visit
WHERE SERVICE like '%ART%' or SERVICE like '%PMTCT%' 
AND REGIMEN_CATEGORY NOT LIKE '%PMTCT Child%' //